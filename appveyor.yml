image:
- Visual Studio 2017
- Ubuntu

stack: 
  - python 3.6
  - python 3.7

install:
  - "git submodule update --init --recursive"
  - cmd: "SET PATH=%PYTHON%;%PATH%"
  - "python -V"
  - "pip --version"
  - "pip install pep8"
  - cmd: "py -3 -m pip install mypy"
  - cmd: "py -3 -m  pip install -r requirements.txt"
  - sh: "pip install mypy"
  - sh: "pip install -r requirements.txt"
  - sh: "apt-get install libxcb-xkb1 libxcb-icccm4 libxcb-image0 libxcb-render-util0"
  - sh: "sudo apt-get install libxkbcommon-x11-0"
  - sh: "sudo apt-get install libx11-xcb1"
  - sh: "sudo apt-get install --reinstall libxcb-xinerama0"
  - sh: "sudo ln /usr/lib/x86_64-linux-gnu/qt5/plugins/platforms/ /usr/bin/"


build: off

test_script:
  - cmd: "echo program will start"
  # - cmd: "start /B py -3 zubax-kucher"
  - sh: "LD_LIBRARY_PATH=. QT_DEBUG_PLUGINS=1 ./zubax-kucher"
  - cmd: "echo program started"
  - cmd: "timeout 10"
  - cmd: "echo timeout over"
  # - cmd: "taskkill /fi \"windowtitle eq Zubax Kucher\""

after_test:
  - "pep8 --max-line-length=120 --exclude libraries"
  - "mypy zubax-kucher"
