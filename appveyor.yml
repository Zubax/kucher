image:
- Ubuntu
- Visual Studio 2017

stack: 
  - python 3.6
  - python 3.7

install:
  - "git submodule update --init --recursive"
  - cmd: "SET PATH=%PYTHON%;%PATH%"
  - "python -V"
  - "pip --version"
  - "pip install pep8"
  - cmd: "py -3 -m pip install mypy"
  - cmd: "py -3 -m  pip install -r requirements.txt"
  - sh: "pip install mypy"
  - sh: "pip install -r requirements.txt"


build: off

test_script:
  - cmd: "start py -3 zubax-kucher & timeout 20 & taskkill /fi \"windowtitle eq Zubax Kucher\""
  - sh: "export QT_QPA_PLATFORM=offscreen"
  - sh: "(timeout 20s ./zubax-kucher; exit 0)"

after_test:
  - cdm: "mypy -V"
  - cdm: "mypy zubax-kucher"
  - sh: "mypy zubax-kucher"
  - sh: "(pep8 --max-line-length=120 --exclude libraries; exit 0)"
  - cmd: "pep8 --max-line-length=120 --exclude libraries || ver > nul"
